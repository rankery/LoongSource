Quest_ZiCai={}
Quest_ZiCai[47]={TargetType=QuestTargetType["Collect"], TargetID1=2000001, TargetID2=0, TargetID3=0, TargetID4=0, Num1=4, Num2=0, Num3=0, Num4=0, MsgID=12004}
Quest_ZiCai[48]={TargetType=QuestTargetType["Collect"], TargetID1=2000011, TargetID2=0, TargetID3=0, TargetID4=0, Num1=4, Num2=0, Num3=0, Num4=0, MsgID=12004}
Quest_ZiCai[49]={TargetType=QuestTargetType["Collect"], TargetID1=2000101, TargetID2=0, TargetID3=0, TargetID4=0, Num1=4, Num2=0, Num3=0, Num4=0, MsgID=12004}
Quest_ZiCai[50]={TargetType=QuestTargetType["Collect"], TargetID1=2000206, TargetID2=0, TargetID3=0, TargetID4=0, Num1=4, Num2=0, Num3=0, Num4=0, MsgID=12004}
Quest_ZiCai[51]={TargetType=QuestTargetType["Collect"], TargetID1=2000211, TargetID2=0, TargetID3=0, TargetID4=0, Num1=4, Num2=0, Num3=0, Num4=0, MsgID=12004}
Quest_ZiCai[52]={TargetType=QuestTargetType["Collect"], TargetID1=2000311, TargetID2=0, TargetID3=0, TargetID4=0, Num1=4, Num2=0, Num3=0, Num4=0, MsgID=12004}
Quest_ZiCai[53]={TargetType=QuestTargetType["Collect"], TargetID1=2000321, TargetID2=0, TargetID3=0, TargetID4=0, Num1=4, Num2=0, Num3=0, Num4=0, MsgID=12004}
Quest_ZiCai[54]={TargetType=QuestTargetType["Collect"], TargetID1=2000006, TargetID2=0, TargetID3=0, TargetID4=0, Num1=4, Num2=0, Num3=0, Num4=0, MsgID=12004}
Quest_ZiCai[55]={TargetType=QuestTargetType["Collect"], TargetID1=2000016, TargetID2=0, TargetID3=0, TargetID4=0, Num1=4, Num2=0, Num3=0, Num4=0, MsgID=12004}
Quest_ZiCai[56]={TargetType=QuestTargetType["Collect"], TargetID1=2000106, TargetID2=0, TargetID3=0, TargetID4=0, Num1=4, Num2=0, Num3=0, Num4=0, MsgID=12004}
Quest_ZiCai[57]={TargetType=QuestTargetType["Collect"], TargetID1=2000201, TargetID2=0, TargetID3=0, TargetID4=0, Num1=4, Num2=0, Num3=0, Num4=0, MsgID=12004}
Quest_ZiCai[58]={TargetType=QuestTargetType["Collect"], TargetID1=2000216, TargetID2=0, TargetID3=0, TargetID4=0, Num1=4, Num2=0, Num3=0, Num4=0, MsgID=12004}
Quest_ZiCai[59]={TargetType=QuestTargetType["Collect"], TargetID1=2000301, TargetID2=0, TargetID3=0, TargetID4=0, Num1=4, Num2=0, Num3=0, Num4=0, MsgID=12004}
Quest_ZiCai[60]={TargetType=QuestTargetType["Collect"], TargetID1=2000306, TargetID2=0, TargetID3=0, TargetID4=0, Num1=4, Num2=0, Num3=0, Num4=0, MsgID=12004}
Quest_ZiCai[61]={TargetType=QuestTargetType["Collect"], TargetID1=2000021, TargetID2=0, TargetID3=0, TargetID4=0, Num1=2, Num2=0, Num3=0, Num4=0, MsgID=12004}
Quest_ZiCai[62]={TargetType=QuestTargetType["Collect"], TargetID1=2000111, TargetID2=0, TargetID3=0, TargetID4=0, Num1=2, Num2=0, Num3=0, Num4=0, MsgID=12004}
Quest_ZiCai[63]={TargetType=QuestTargetType["Collect"], TargetID1=2000221, TargetID2=0, TargetID3=0, TargetID4=0, Num1=2, Num2=0, Num3=0, Num4=0, MsgID=12004}
Quest_ZiCai[64]={TargetType=QuestTargetType["Collect"], TargetID1=2000316, TargetID2=0, TargetID3=0, TargetID4=0, Num1=2, Num2=0, Num3=0, Num4=0, MsgID=12004}
Quest_ZiCai[65]={TargetType=QuestTargetType["Collect"], TargetID1=2000116, TargetID2=0, TargetID3=0, TargetID4=0, Num1=2, Num2=0, Num3=0, Num4=0, MsgID=12004}
Quest_ZiCai[154]={TargetType=QuestTargetType["Collect"], TargetID1=2430063, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[155]={TargetType=QuestTargetType["Collect"], TargetID1=2430064, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[156]={TargetType=QuestTargetType["Collect"], TargetID1=2430065, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[157]={TargetType=QuestTargetType["Collect"], TargetID1=2430081, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[158]={TargetType=QuestTargetType["Collect"], TargetID1=2430082, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[159]={TargetType=QuestTargetType["Collect"], TargetID1=2430083, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[160]={TargetType=QuestTargetType["Collect"], TargetID1=2430101, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[161]={TargetType=QuestTargetType["Collect"], TargetID1=2430102, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[162]={TargetType=QuestTargetType["Collect"], TargetID1=2430103, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[163]={TargetType=QuestTargetType["Collect"], TargetID1=2430104, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[164]={TargetType=QuestTargetType["Collect"], TargetID1=2430121, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[165]={TargetType=QuestTargetType["Collect"], TargetID1=2430122, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[166]={TargetType=QuestTargetType["Collect"], TargetID1=2430123, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[167]={TargetType=QuestTargetType["Collect"], TargetID1=2430124, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[168]={TargetType=QuestTargetType["Collect"], TargetID1=2430141, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[169]={TargetType=QuestTargetType["Collect"], TargetID1=2430142, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[170]={TargetType=QuestTargetType["Collect"], TargetID1=2430143, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[171]={TargetType=QuestTargetType["Collect"], TargetID1=2430144, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[172]={TargetType=QuestTargetType["Collect"], TargetID1=2430145, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[173]={TargetType=QuestTargetType["Collect"], TargetID1=2430161, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[174]={TargetType=QuestTargetType["Collect"], TargetID1=2430162, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[175]={TargetType=QuestTargetType["Collect"], TargetID1=2430163, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[176]={TargetType=QuestTargetType["Collect"], TargetID1=2430164, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[177]={TargetType=QuestTargetType["Collect"], TargetID1=2430165, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[178]={TargetType=QuestTargetType["Collect"], TargetID1=2430181, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[179]={TargetType=QuestTargetType["Collect"], TargetID1=2430182, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[180]={TargetType=QuestTargetType["Collect"], TargetID1=2430183, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[181]={TargetType=QuestTargetType["Collect"], TargetID1=2430201, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[182]={TargetType=QuestTargetType["Collect"], TargetID1=2430202, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[183]={TargetType=QuestTargetType["Collect"], TargetID1=2430203, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[184]={TargetType=QuestTargetType["Collect"], TargetID1=2430204, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[185]={TargetType=QuestTargetType["Collect"], TargetID1=2430205, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[186]={TargetType=QuestTargetType["Collect"], TargetID1=2430221, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[187]={TargetType=QuestTargetType["Collect"], TargetID1=2430222, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[188]={TargetType=QuestTargetType["Collect"], TargetID1=2430223, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[189]={TargetType=QuestTargetType["Collect"], TargetID1=2430224, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[190]={TargetType=QuestTargetType["Collect"], TargetID1=2430225, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[191]={TargetType=QuestTargetType["Collect"], TargetID1=2430241, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[192]={TargetType=QuestTargetType["Collect"], TargetID1=2430242, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[193]={TargetType=QuestTargetType["Collect"], TargetID1=2430243, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[194]={TargetType=QuestTargetType["Collect"], TargetID1=2430244, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[195]={TargetType=QuestTargetType["Collect"], TargetID1=2430245, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[196]={TargetType=QuestTargetType["Collect"], TargetID1=2430261, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[197]={TargetType=QuestTargetType["Collect"], TargetID1=2430262, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[198]={TargetType=QuestTargetType["Collect"], TargetID1=2430263, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[199]={TargetType=QuestTargetType["Collect"], TargetID1=2430264, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[200]={TargetType=QuestTargetType["Collect"], TargetID1=2430281, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[201]={TargetType=QuestTargetType["Collect"], TargetID1=2430282, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[202]={TargetType=QuestTargetType["Collect"], TargetID1=2430283, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[203]={TargetType=QuestTargetType["Collect"], TargetID1=2430284, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[204]={TargetType=QuestTargetType["Collect"], TargetID1=2430285, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[205]={TargetType=QuestTargetType["Collect"], TargetID1=2430301, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[206]={TargetType=QuestTargetType["Collect"], TargetID1=2430302, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[207]={TargetType=QuestTargetType["Collect"], TargetID1=2430303, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[208]={TargetType=QuestTargetType["Collect"], TargetID1=2430304, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[209]={TargetType=QuestTargetType["Collect"], TargetID1=2430305, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[210]={TargetType=QuestTargetType["Collect"], TargetID1=2430321, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[211]={TargetType=QuestTargetType["Collect"], TargetID1=2430322, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[212]={TargetType=QuestTargetType["Collect"], TargetID1=2430323, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[213]={TargetType=QuestTargetType["Collect"], TargetID1=2430324, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[214]={TargetType=QuestTargetType["Collect"], TargetID1=2430325, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[215]={TargetType=QuestTargetType["Collect"], TargetID1=2430341, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[216]={TargetType=QuestTargetType["Collect"], TargetID1=2430342, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[217]={TargetType=QuestTargetType["Collect"], TargetID1=2430343, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[218]={TargetType=QuestTargetType["Collect"], TargetID1=2430344, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[219]={TargetType=QuestTargetType["Collect"], TargetID1=2430345, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[220]={TargetType=QuestTargetType["Collect"], TargetID1=2430361, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[221]={TargetType=QuestTargetType["Collect"], TargetID1=2430362, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[222]={TargetType=QuestTargetType["Collect"], TargetID1=2430363, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[223]={TargetType=QuestTargetType["Collect"], TargetID1=2430364, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[224]={TargetType=QuestTargetType["Collect"], TargetID1=2430365, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[225]={TargetType=QuestTargetType["Collect"], TargetID1=2430381, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[226]={TargetType=QuestTargetType["Collect"], TargetID1=2430382, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[227]={TargetType=QuestTargetType["Collect"], TargetID1=2430383, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[228]={TargetType=QuestTargetType["Collect"], TargetID1=2430384, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[229]={TargetType=QuestTargetType["Collect"], TargetID1=2430385, TargetID2=0, TargetID3=0, TargetID4=0, Num1=8, Num2=0, Num3=0, Num4=0, MsgID=12003}
Quest_ZiCai[241]={TargetType=QuestTargetType["Collect"], TargetID1=3120101, TargetID2=0, TargetID3=0, TargetID4=0, Num1=1, Num2=0, Num3=0, Num4=0, MsgID=12005}


--接取任务
function x30002_OnQuestInit(MapID, InstanceID, QuestID, OwnerID, NPCID)

	--得到表中的一个索引

	local Index = 0
	local k = math.random(100)
	local rolelevel = role.GetRoleLevel(MapID, InstanceID, OwnerID)

	if k>95 then
		if rolelevel>=90 then
			Index = 241
			role.AddRoleItem(MapID, InstanceID, OwnerID, 3120000+math.random(7), 1, -1, 8, 102)
		elseif rolelevel>=80 then
			Index = 241
			role.AddRoleItem(MapID, InstanceID, OwnerID, 3120000+math.random(6), 1, -1, 8, 102)
		elseif rolelevel>=70 then
			Index = 241
			role.AddRoleItem(MapID, InstanceID, OwnerID, 3120000+math.random(5), 1, -1, 8, 102)
		elseif rolelevel>=60 then
			Index = 241
			role.AddRoleItem(MapID, InstanceID, OwnerID, 3120000+math.random(4), 1, -1, 8, 102)
		elseif rolelevel>=50 then
			Index = 241
			role.AddRoleItem(MapID, InstanceID, OwnerID, 3120000+math.random(3), 1, -1, 8, 102)
		elseif rolelevel>=40 then
			Index = 241
			role.AddRoleItem(MapID, InstanceID, OwnerID, 3120000+math.random(2), 1, -1, 8, 102)
		elseif rolelevel>=30 then
			Index = 241
			role.AddRoleItem(MapID, InstanceID, OwnerID, 3120001, 1, -1, 8, 102)
		end
	elseif k>20 then
		if rolelevel>=100 then
			Index = 224+math.random(5)
		elseif rolelevel>=90 then
			Index = 214+math.random(10)
		elseif rolelevel>=80 then
			Index = 204+math.random(10)
		elseif rolelevel>=70 then
			Index = 195+math.random(9)
		elseif rolelevel>=60 then
			Index = 185+math.random(10)
		elseif rolelevel>=50 then
			Index = 177+math.random(8)
		elseif rolelevel>=40 then
			Index = 167+math.random(10)
		elseif rolelevel>=30 then
			Index = 153+math.random(14)
		end
	elseif k>=0 then
		if rolelevel>=80 then
			Index = 46+math.random(19)
		elseif rolelevel>=70 then
			Index = 46+math.random(18)
		elseif rolelevel>=50 then
			Index = 46+math.random(14)
		elseif rolelevel>=30 then
			Index = 46+math.random(7)
		end
	end

	role.SetRoleScriptData(OwnerID, 1, RoleDataType["ZiCai_Index"], Index)

	--初始化任务的动态数据
	role.QuestInit(OwnerID, QuestID, GetRandQuestTable(Quest_ZiCai, Index))

	--同步客户端总任务环数和任务说明
	local LoopNum = role.GetRoleScriptData(OwnerID, 1, RoleDataType["ZiCai"])

	local MsgID = msg.BeginMsgEvent()
	msg.AddMsgEvent(MsgID, 11, QuestID)
	msg.AddMsgEvent(MsgID, 10, LoopNum)
	msg.AddMsgEvent(MsgID, 1, Quest_ZiCai[Index].MsgID)
	msg.DispatchRoleMsgEvent(OwnerID, MsgID)
end

--完成任务
function x30002_OnComplete(MapID, InstanceID, QuestID, OwnerID, NPCID)

	local exp_award = {}
	exp_award[2] = 780
	exp_award[3] = 2253
	exp_award[4] = 5994
	exp_award[5] = 11064
	exp_award[6] = 16734
	exp_award[7] = 23004
	exp_award[8] = 29874
	exp_award[9] = 37344
	exp_award[10] = 45414

	local rolelevel = role.GetRoleLevel(MapID, InstanceID, OwnerID)
	local k = math.floor(rolelevel/10)
	if k>10 then
		k = 10
	end

	--得到当前任务总环数
	local LoopNum = role.GetRoleScriptData(OwnerID, 1, RoleDataType["ZiCai"])
	local TotalNum = role.GetRoleScriptData(OwnerID, 1, RoleDataType["ZiCai_Total"])
	--计算环数
	local LoopNum_Ring = LoopNum % 10
	if LoopNum_Ring == 0 then
		LoopNum_Ring = 10
	end
	--计算轮数
	local LoopNum_Round = (LoopNum - LoopNum_Ring) /10 + 1
	--计算经验奖励
	local Exp = exp_award[k]

	--奖励玩家经验
	role.AddRoleExp(MapID, InstanceID, OwnerID, Exp)

	--奖励玩家帮派贡献,增加帮派资材
	local GuildID = guild.GetRoleGuildID(OwnerID)
	guild.ModifyRoleContribute(GuildID, OwnerID, 5, 102)
	guild.ModifyGuildMaterial(GuildID, OwnerID, 10, 102)

	--第5，8，10环时奖励帮派功劳帖
	if (LoopNum_Ring==5) or (LoopNum_Ring==8) or (LoopNum_Ring==10) then
		role.AddRoleItem(MapID, InstanceID, OwnerID, 3120000, 1, -1, 8, 102)
	end

	--奖励玩家金钱
	local silver=0
	--金钱奖励系数
	for i=1,30 do
		if i*5>rolelevel then
			silver=activity_money[i*5]*activity_money_rate["ZiCai"]
			break
		end
	end
	silver = silver*(1+(LoopNum_Ring-1)*0.3)/2.35
	role.AddRoleSilver(MapID, InstanceID, OwnerID, silver, 102)

	--总任务环数加一
	role.SetRoleScriptData(OwnerID, 1, RoleDataType["ZiCai"], LoopNum+1)
	role.SetRoleScriptData(OwnerID, 1, RoleDataType["ZiCai_Total"], TotalNum+1)
	--设置当前帮派任务Index为0(GT_INVALID)
	role.SetRoleScriptData(OwnerID, 1, RoleDataType["ZiCai_Index"], 0)

	--增加进阶实力值
		Increase_shili(MapID, InstanceID, OwnerID, 0, 2, "jinjieshili_Q")

end

--放弃任务
function x30002_OnCancel(MapID, InstanceID, QuestID, OwnerID)
	local LoopNum = role.GetRoleScriptData(OwnerID, 1, RoleDataType["ZiCai"])
	local TotalNum = role.GetRoleScriptData(OwnerID, 1, RoleDataType["ZiCai_Total"])
	local k = LoopNum % 10
	if k == 0 then
		k=10
	end
	--总任务环数加一，当前环数置为1
	role.SetRoleScriptData(OwnerID, 1, RoleDataType["ZiCai"], LoopNum-k+1)
	role.SetRoleScriptData(OwnerID, 1, RoleDataType["ZiCai_Total"], TotalNum+1)
	--设置当前挖宝任务Index为0(GT_INVALID)
	role.SetRoleScriptData(OwnerID, 1, RoleDataType["ZiCai_Index"], 0)
end

function x30002_OnCheckAccept(MapID, InstanceID, QuestID, RoleID, NPCID)
	--判断玩家是否已加入帮派
	local GuildID = guild.GetRoleGuildID(RoleID)
	if GuildID==4294967295 then
		local MsgID = msg.BeginMsgEvent()
		msg.AddMsgEvent(MsgID, 26, 143)
		msg.DispatchRoleMsgEvent(RoleID, MsgID)
		return 0
	end

	--[[判断玩家帮派职位
	local GuildPos=guild.GetRoleGuildPos(GuildID, RoleID)
	if (GuildPos~=2) and (GuildPos~=3) and (GuildPos~=6) and (GuildPos~=7) and (GuildPos~=8) then
		local MsgID = msg.BeginMsgEvent()
		msg.AddMsgEvent(MsgID, 26, 144)
		msg.DispatchRoleMsgEvent(RoleID, MsgID)
		return 0
	end]]

	--判断背包空闲空间是否足够
	local FreeSize = role.GetBagFreeSize(RoleID)
	if(FreeSize < 1) then
		local MsgID = msg.BeginMsgEvent()
		msg.AddMsgEvent(MsgID, 26, 141)
		msg.DispatchRoleMsgEvent(RoleID, MsgID)
		return 0
	end

	--判断本日任务接取次数是否已满
	--得到当前任务总任务环数
	local LoopNum = role.GetRoleScriptData(RoleID, 1, RoleDataType["ZiCai"])
	local TotalNum = role.GetRoleScriptData(RoleID, 1, RoleDataType["ZiCai_Total"])
	local UpdateTime = role.GetRoleScriptData(RoleID, 1, RoleDataType["ZiCai_Update"])

	--总环数为0时，设置总环数为第一环
	if 0 == LoopNum then
		LoopNum = 1
		role.SetRoleScriptData(RoleID, 1, RoleDataType["ZiCai"], LoopNum)
	end
	if 0 == TotalNum then
		TotalNum = 1
		role.SetRoleScriptData(RoleID, 1, RoleDataType["ZiCai_Total"], TotalNum)
	end

	--检测任务上次更新日期，若与当前日期不一致，则重置总环数及更新日期
	local CurTime = tonumber(os.date("%j"))
	if CurTime~=UpdateTime then
		role.SetRoleScriptData(RoleID, 1, RoleDataType["ZiCai"], 1)
		role.SetRoleScriptData(RoleID, 1, RoleDataType["ZiCai_Total"], 1)
		role.SetRoleScriptData(RoleID, 1, RoleDataType["ZiCai_Update"], CurTime)
	end
	--若本日已接取100次，则无法再接取
	if TotalNum > 20 then
		local MsgID = msg.BeginMsgEvent()
		msg.AddMsgEvent(MsgID, 26, 147)
		msg.DispatchRoleMsgEvent(RoleID, MsgID)
		return 0
	end

	return 1
end

function x30002_OnCheckComplete(MapID, InstanceID, QuestID, RoleID, NPCID)
	--判断背包空闲空间是否足够
	local FreeSize = role.GetBagFreeSize(RoleID)
	if(FreeSize < 1) then
		local MsgID = msg.BeginMsgEvent()
		msg.AddMsgEvent(MsgID, 26, 142)
		msg.DispatchRoleMsgEvent(RoleID, MsgID)
		return 0
	end

	return 1
end


aux.RegisterQuestEvent(30002, 1, "x30002_OnComplete")
aux.RegisterQuestEvent(30002, 7, "x30002_OnQuestInit")
aux.RegisterQuestEvent(30002, 2, "x30002_OnCancel")
aux.RegisterQuestEvent(30002, 4, "x30002_OnCheckAccept")
aux.RegisterQuestEvent(30002, 5, "x30002_OnCheckComplete")

function I3120001_CanUse(MapID, InstanceID, TypeID, TargetID)
	local bRet, bIgnore = 0, false

	--判断玩家是否接有挖宝任务
	local Index = role.GetRoleScriptData(TargetID, 1, RoleDataType["ZiCai_Index"])
	if Index == 0 then
		bRet = 42
	end

	--判断使用地点限制
	local x, y ,z = unit.GetPosition(MapID, InstanceID, TargetID)

	if MapID~=3017298127 then
		bRet = 43
	end
	if x>2427 then
		bRet = 43
	end
	if x<2395 then
		bRet = 43
	end
	if z>2314 then
		bRet = 43
	end
	if z<2282 then
		bRet = 43
	end

	return bRet, bIgnore
end

function I3120001_zicai(MapID, InstanceID, TypeID, TargetID)
	local x, y ,z = unit.GetPosition(MapID, InstanceID, TargetID)
	local monsterid = role.GetRoleLevel(MapID, InstanceID, TargetID)
	monsterid = math.floor(monsterid/10)
	if monsterid>10 then
		monsterid=10
	end
	map.MapCreateCreature(MapID, InstanceID, 1530000+monsterid, x+2, y, z+2)
end

aux.RegisterItemEvent(3120001, 0, "I3120001_CanUse")
aux.RegisterItemEvent(3120001, 1, "I3120001_zicai")

function I3120002_CanUse(MapID, InstanceID, TypeID, TargetID)
	local bRet, bIgnore = 0, false

	--判断玩家是否接有挖宝任务
	local Index = role.GetRoleScriptData(TargetID, 1, RoleDataType["ZiCai_Index"])
	if Index == 0 then
		bRet = 42
	end

	--判断使用地点限制
	local x, y ,z = unit.GetPosition(MapID, InstanceID, TargetID)

	if MapID~=3017298383 then
		bRet = 43
	end
	if x>563 then
		bRet = 43
	end
	if x<531 then
		bRet = 43
	end
	if z>2077 then
		bRet = 43
	end
	if z<2045 then
		bRet = 43
	end

	return bRet, bIgnore
end

function I3120002_zicai(MapID, InstanceID, TypeID, TargetID)
	local x, y ,z = unit.GetPosition(MapID, InstanceID, TargetID)
	local monsterid = role.GetRoleLevel(MapID, InstanceID, TargetID)
	monsterid = math.floor(monsterid/10)
	if monsterid>10 then
		monsterid=10
	end
	map.MapCreateCreature(MapID, InstanceID, 1530000+monsterid, x+2, y, z+2)
end

aux.RegisterItemEvent(3120002, 0, "I3120002_CanUse")
aux.RegisterItemEvent(3120002, 1, "I3120002_zicai")

function I3120003_CanUse(MapID, InstanceID, TypeID, TargetID)
	local bRet, bIgnore = 0, false

	--判断玩家是否接有挖宝任务
	local Index = role.GetRoleScriptData(TargetID, 1, RoleDataType["ZiCai_Index"])
	if Index == 0 then
		bRet = 42
	end

	--判断使用地点限制
	local x, y ,z = unit.GetPosition(MapID, InstanceID, TargetID)

	if MapID~=3017299663 then
		bRet = 43
	end
	if x>2175 then
		bRet = 43
	end
	if x<2143 then
		bRet = 43
	end
	if z>3111 then
		bRet = 43
	end
	if z<3079 then
		bRet = 43
	end

	return bRet, bIgnore
end

function I3120003_zicai(MapID, InstanceID, TypeID, TargetID)
	local x, y ,z = unit.GetPosition(MapID, InstanceID, TargetID)
	local monsterid = role.GetRoleLevel(MapID, InstanceID, TargetID)
	monsterid = math.floor(monsterid/10)
	if monsterid>10 then
		monsterid=10
	end
	map.MapCreateCreature(MapID, InstanceID, 1530000+monsterid, x+2, y, z+2)
end

aux.RegisterItemEvent(3120003, 0, "I3120003_CanUse")
aux.RegisterItemEvent(3120003, 1, "I3120003_zicai")

function I3120004_CanUse(MapID, InstanceID, TypeID, TargetID)
	local bRet, bIgnore = 0, false

	--判断玩家是否接有挖宝任务
	local Index = role.GetRoleScriptData(TargetID, 1, RoleDataType["ZiCai_Index"])
	if Index == 0 then
		bRet = 42
	end

	--判断使用地点限制
	local x, y ,z = unit.GetPosition(MapID, InstanceID, TargetID)

	if MapID~=3017299919 then
		bRet = 43
	end
	if x>975 then
		bRet = 43
	end
	if x<943 then
		bRet = 43
	end
	if z>1153 then
		bRet = 43
	end
	if z<1121 then
		bRet = 43
	end

	return bRet, bIgnore
end

function I3120004_zicai(MapID, InstanceID, TypeID, TargetID)
	local x, y ,z = unit.GetPosition(MapID, InstanceID, TargetID)
	local monsterid = role.GetRoleLevel(MapID, InstanceID, TargetID)
	monsterid = math.floor(monsterid/10)
	if monsterid>10 then
		monsterid=10
	end
	map.MapCreateCreature(MapID, InstanceID, 1530000+monsterid, x+2, y, z+2)
end

aux.RegisterItemEvent(3120004, 0, "I3120004_CanUse")
aux.RegisterItemEvent(3120004, 1, "I3120004_zicai")

function I3120005_CanUse(MapID, InstanceID, TypeID, TargetID)
	local bRet, bIgnore = 0, false

	--判断玩家是否接有挖宝任务
	local Index = role.GetRoleScriptData(TargetID, 1, RoleDataType["ZiCai_Index"])
	if Index == 0 then
		bRet = 42
	end

	--判断使用地点限制
	local x, y ,z = unit.GetPosition(MapID, InstanceID, TargetID)

	if MapID~=3017299151 then
		bRet = 43
	end
	if x>2228 then
		bRet = 43
	end
	if x<2196 then
		bRet = 43
	end
	if z>1646 then
		bRet = 43
	end
	if z<1614 then
		bRet = 43
	end

	return bRet, bIgnore
end

function I3120005_zicai(MapID, InstanceID, TypeID, TargetID)
	local x, y ,z = unit.GetPosition(MapID, InstanceID, TargetID)
	local monsterid = role.GetRoleLevel(MapID, InstanceID, TargetID)
	monsterid = math.floor(monsterid/10)
	if monsterid>10 then
		monsterid=10
	end
	map.MapCreateCreature(MapID, InstanceID, 1530000+monsterid, x+2, y, z+2)
end

aux.RegisterItemEvent(3120005, 0, "I3120005_CanUse")
aux.RegisterItemEvent(3120005, 1, "I3120005_zicai")

function I3120006_CanUse(MapID, InstanceID, TypeID, TargetID)
	local bRet, bIgnore = 0, false

	--判断玩家是否接有挖宝任务
	local Index = role.GetRoleScriptData(TargetID, 1, RoleDataType["ZiCai_Index"])
	if Index == 0 then
		bRet = 42
	end

	--判断使用地点限制
	local x, y ,z = unit.GetPosition(MapID, InstanceID, TargetID)

	if MapID~=1146339967 then
		bRet = 43
	end
	if x>2408 then
		bRet = 43
	end
	if x<2376 then
		bRet = 43
	end
	if z>1932 then
		bRet = 43
	end
	if z<1900 then
		bRet = 43
	end

	return bRet, bIgnore
end

function I3120006_zicai(MapID, InstanceID, TypeID, TargetID)
	local x, y ,z = unit.GetPosition(MapID, InstanceID, TargetID)
	local monsterid = role.GetRoleLevel(MapID, InstanceID, TargetID)
	monsterid = math.floor(monsterid/10)
	if monsterid>10 then
		monsterid=10
	end
	map.MapCreateCreature(MapID, InstanceID, 1530000+monsterid, x+2, y, z+2)
end

aux.RegisterItemEvent(3120006, 0, "I3120006_CanUse")
aux.RegisterItemEvent(3120006, 1, "I3120006_zicai")

function I3120007_CanUse(MapID, InstanceID, TypeID, TargetID)
	local bRet, bIgnore = 0, false

	--判断玩家是否接有挖宝任务
	local Index = role.GetRoleScriptData(TargetID, 1, RoleDataType["ZiCai_Index"])
	if Index == 0 then
		bRet = 42
	end

	--判断使用地点限制
	local x, y ,z = unit.GetPosition(MapID, InstanceID, TargetID)

	if MapID~=3017299407 then
		bRet = 43
	end
	if x<1769 then
		bRet = 43
	end
	if x>1801 then
		bRet = 43
	end
	if z<1919 then
		bRet = 43
	end
	if z>1951 then
		bRet = 43
	end

	return bRet, bIgnore
end

function I3120007_zicai(MapID, InstanceID, TypeID, TargetID)
	local x, y ,z = unit.GetPosition(MapID, InstanceID, TargetID)
	local monsterid = role.GetRoleLevel(MapID, InstanceID, TargetID)
	monsterid = math.floor(monsterid/10)
	if monsterid>10 then
		monsterid=10
	end
	map.MapCreateCreature(MapID, InstanceID, 1530000+monsterid, x+2, y, z+2)
end

aux.RegisterItemEvent(3120007, 0, "I3120007_CanUse")
aux.RegisterItemEvent(3120007, 1, "I3120007_zicai")
