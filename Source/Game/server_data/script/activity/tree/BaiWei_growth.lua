--普通种植道具	im种植道具为普通6倍	高级种子在普通基础上*2

growth_exp = {}
growth_exp[1] = {pt=113,im=678,gaojipt=226,gaojiim=1356}
growth_exp[2] = {pt=124,im=744,gaojipt=248,gaojiim=1488}
growth_exp[3] = {pt=135,im=810,gaojipt=270,gaojiim=1620}
growth_exp[4] = {pt=146,im=876,gaojipt=292,gaojiim=1752}
growth_exp[5] = {pt=158,im=948,gaojipt=316,gaojiim=1896}
growth_exp[6] = {pt=169,im=1014,gaojipt=338,gaojiim=2028}
growth_exp[7] = {pt=180,im=1080,gaojipt=360,gaojiim=2160}
growth_exp[8] = {pt=191,im=1146,gaojipt=382,gaojiim=2292}
growth_exp[9] = {pt=203,im=1218,gaojipt=406,gaojiim=2436}
growth_exp[10] = {pt=214,im=1284,gaojipt=428,gaojiim=2568}
growth_exp[11] = {pt=225,im=1350,gaojipt=450,gaojiim=2700}
growth_exp[12] = {pt=236,im=1416,gaojipt=472,gaojiim=2832}
growth_exp[13] = {pt=248,im=1488,gaojipt=496,gaojiim=2976}
growth_exp[14] = {pt=259,im=1554,gaojipt=518,gaojiim=3108}
growth_exp[15] = {pt=270,im=1620,gaojipt=540,gaojiim=3240}
growth_exp[16] = {pt=281,im=1686,gaojipt=562,gaojiim=3372}
growth_exp[17] = {pt=293,im=1758,gaojipt=586,gaojiim=3516}
growth_exp[18] = {pt=304,im=1824,gaojipt=608,gaojiim=3648}
growth_exp[19] = {pt=315,im=1890,gaojipt=630,gaojiim=3780}
growth_exp[20] = {pt=326,im=1956,gaojipt=652,gaojiim=3912}
growth_exp[21] = {pt=338,im=2028,gaojipt=676,gaojiim=4056}
growth_exp[22] = {pt=360,im=2160,gaojipt=720,gaojiim=4320}
growth_exp[23] = {pt=371,im=2226,gaojipt=742,gaojiim=4452}
growth_exp[24] = {pt=394,im=2364,gaojipt=788,gaojiim=4728}
growth_exp[25] = {pt=405,im=2430,gaojipt=810,gaojiim=4860}
growth_exp[26] = {pt=428,im=2568,gaojipt=856,gaojiim=5136}
growth_exp[27] = {pt=439,im=2634,gaojipt=878,gaojiim=5268}
growth_exp[28] = {pt=461,im=2766,gaojipt=922,gaojiim=5532}
growth_exp[29] = {pt=473,im=2838,gaojipt=946,gaojiim=5676}
growth_exp[30] = {pt=495,im=2970,gaojipt=990,gaojiim=5940}
growth_exp[31] = {pt=506,im=3036,gaojipt=1012,gaojiim=6072}
growth_exp[32] = {pt=529,im=3174,gaojipt=1058,gaojiim=6348}
growth_exp[33] = {pt=540,im=3240,gaojipt=1080,gaojiim=6480}
growth_exp[34] = {pt=563,im=3378,gaojipt=1126,gaojiim=6756}
growth_exp[35] = {pt=574,im=3444,gaojipt=1148,gaojiim=6888}
growth_exp[36] = {pt=596,im=3576,gaojipt=1192,gaojiim=7152}
growth_exp[37] = {pt=608,im=3648,gaojipt=1216,gaojiim=7296}
growth_exp[38] = {pt=630,im=3780,gaojipt=1260,gaojiim=7560}
growth_exp[39] = {pt=641,im=3846,gaojipt=1282,gaojiim=7692}
growth_exp[40] = {pt=664,im=3984,gaojipt=1328,gaojiim=7968}
growth_exp[41] = {pt=675,im=4050,gaojipt=1350,gaojiim=8100}
growth_exp[42] = {pt=709,im=4254,gaojipt=1418,gaojiim=8508}
growth_exp[43] = {pt=731,im=4386,gaojipt=1462,gaojiim=8772}
growth_exp[44] = {pt=765,im=4590,gaojipt=1530,gaojiim=9180}
growth_exp[45] = {pt=788,im=4728,gaojipt=1576,gaojiim=9456}
growth_exp[46] = {pt=821,im=4926,gaojipt=1642,gaojiim=9852}
growth_exp[47] = {pt=844,im=5064,gaojipt=1688,gaojiim=10128}
growth_exp[48] = {pt=878,im=5268,gaojipt=1756,gaojiim=10536}
growth_exp[49] = {pt=900,im=5400,gaojipt=1800,gaojiim=10800}
growth_exp[50] = {pt=934,im=5604,gaojipt=1868,gaojiim=11208}
growth_exp[51] = {pt=956,im=5736,gaojipt=1912,gaojiim=11472}
growth_exp[52] = {pt=990,im=5940,gaojipt=1980,gaojiim=11880}
growth_exp[53] = {pt=1013,im=6078,gaojipt=2026,gaojiim=12156}
growth_exp[54] = {pt=1046,im=6276,gaojipt=2092,gaojiim=12552}
growth_exp[55] = {pt=1069,im=6414,gaojipt=2138,gaojiim=12828}
growth_exp[56] = {pt=1103,im=6618,gaojipt=2206,gaojiim=13236}
growth_exp[57] = {pt=1125,im=6750,gaojipt=2250,gaojiim=13500}
growth_exp[58] = {pt=1159,im=6954,gaojipt=2318,gaojiim=13908}
growth_exp[59] = {pt=1181,im=7086,gaojipt=2362,gaojiim=14172}
growth_exp[60] = {pt=1226,im=7356,gaojipt=2452,gaojiim=14712}
growth_exp[61] = {pt=1271,im=7626,gaojipt=2542,gaojiim=15252}
growth_exp[62] = {pt=1316,im=7896,gaojipt=2632,gaojiim=15792}
growth_exp[63] = {pt=1361,im=8166,gaojipt=2722,gaojiim=16332}
growth_exp[64] = {pt=1406,im=8436,gaojipt=2812,gaojiim=16872}
growth_exp[65] = {pt=1451,im=8706,gaojipt=2902,gaojiim=17412}
growth_exp[66] = {pt=1496,im=8976,gaojipt=2992,gaojiim=17952}
growth_exp[67] = {pt=1541,im=9246,gaojipt=3082,gaojiim=18492}
growth_exp[68] = {pt=1586,im=9516,gaojipt=3172,gaojiim=19032}
growth_exp[69] = {pt=1631,im=9786,gaojipt=3262,gaojiim=19572}
growth_exp[70] = {pt=1676,im=10056,gaojipt=3352,gaojiim=20112}
growth_exp[71] = {pt=1721,im=10326,gaojipt=3442,gaojiim=20652}
growth_exp[72] = {pt=1766,im=10596,gaojipt=3532,gaojiim=21192}
growth_exp[73] = {pt=1811,im=10866,gaojipt=3622,gaojiim=21732}
growth_exp[74] = {pt=1856,im=11136,gaojipt=3712,gaojiim=22272}
growth_exp[75] = {pt=1901,im=11406,gaojipt=3802,gaojiim=22812}
growth_exp[76] = {pt=1946,im=11676,gaojipt=3892,gaojiim=23352}
growth_exp[77] = {pt=1991,im=11946,gaojipt=3982,gaojiim=23892}
growth_exp[78] = {pt=2036,im=12216,gaojipt=4072,gaojiim=24432}
growth_exp[79] = {pt=2081,im=12486,gaojipt=4162,gaojiim=24972}
growth_exp[80] = {pt=2149,im=12894,gaojipt=4298,gaojiim=25788}
growth_exp[81] = {pt=2216,im=13296,gaojipt=4432,gaojiim=26592}
growth_exp[82] = {pt=2284,im=13704,gaojipt=4568,gaojiim=27408}
growth_exp[83] = {pt=2351,im=14106,gaojipt=4702,gaojiim=28212}
growth_exp[84] = {pt=2419,im=14514,gaojipt=4838,gaojiim=29028}
growth_exp[85] = {pt=2486,im=14916,gaojipt=4972,gaojiim=29832}
growth_exp[86] = {pt=2531,im=15186,gaojipt=5062,gaojiim=30372}
growth_exp[87] = {pt=2576,im=15456,gaojipt=5152,gaojiim=30912}
growth_exp[88] = {pt=2621,im=15726,gaojipt=5242,gaojiim=31452}
growth_exp[89] = {pt=2666,im=15996,gaojipt=5332,gaojiim=31992}
growth_exp[90] = {pt=2711,im=16266,gaojipt=5422,gaojiim=32532}
growth_exp[91] = {pt=2756,im=16536,gaojipt=5512,gaojiim=33072}
growth_exp[92] = {pt=2801,im=16806,gaojipt=5602,gaojiim=33612}
growth_exp[93] = {pt=2846,im=17076,gaojipt=5692,gaojiim=34152}
growth_exp[94] = {pt=2891,im=17346,gaojipt=5782,gaojiim=34692}
growth_exp[95] = {pt=2936,im=17616,gaojipt=5872,gaojiim=35232}
growth_exp[96] = {pt=2981,im=17886,gaojipt=5962,gaojiim=35772}
growth_exp[97] = {pt=3026,im=18156,gaojipt=6052,gaojiim=36312}
growth_exp[98] = {pt=3071,im=18426,gaojipt=6142,gaojiim=36852}
growth_exp[99] = {pt=3116,im=18696,gaojipt=6232,gaojiim=37392}
growth_exp[100] = {pt=3161,im=18966,gaojipt=6322,gaojiim=37932}
growth_exp[101] = {pt=3161,im=18966,gaojipt=6322,gaojiim=37932}
growth_exp[102] = {pt=3161,im=18966,gaojipt=6322,gaojiim=37932}
growth_exp[103] = {pt=3161,im=18966,gaojipt=6322,gaojiim=37932}
growth_exp[104] = {pt=3161,im=18966,gaojipt=6322,gaojiim=37932}
growth_exp[105] = {pt=3161,im=18966,gaojipt=6322,gaojiim=37932}
growth_exp[106] = {pt=3161,im=18966,gaojipt=6322,gaojiim=37932}
growth_exp[107] = {pt=3161,im=18966,gaojipt=6322,gaojiim=37932}
growth_exp[108] = {pt=3161,im=18966,gaojipt=6322,gaojiim=37932}
growth_exp[109] = {pt=3161,im=18966,gaojipt=6322,gaojiim=37932}
growth_exp[110] = {pt=3161,im=18966,gaojipt=6322,gaojiim=37932}
growth_exp[111] = {pt=3161,im=18966,gaojipt=6322,gaojiim=37932}
growth_exp[112] = {pt=3161,im=18966,gaojipt=6322,gaojiim=37932}
growth_exp[113] = {pt=3161,im=18966,gaojipt=6322,gaojiim=37932}
growth_exp[114] = {pt=3161,im=18966,gaojipt=6322,gaojiim=37932}
growth_exp[115] = {pt=3161,im=18966,gaojipt=6322,gaojiim=37932}
growth_exp[116] = {pt=3161,im=18966,gaojipt=6322,gaojiim=37932}
growth_exp[117] = {pt=3161,im=18966,gaojipt=6322,gaojiim=37932}
growth_exp[118] = {pt=3161,im=18966,gaojipt=6322,gaojiim=37932}
growth_exp[119] = {pt=3161,im=18966,gaojipt=6322,gaojiim=37932}
growth_exp[120] = {pt=3161,im=18966,gaojipt=6322,gaojiim=37932}


--与百味灵壤对话，百味土
function BaiWeiTu_OnTalk(MapID, InstanceID, TargetID, TargetTypeID, RoleID, TalkIndex)
	local seedowner = cre.GetCreatureScriptData(MapID, InstanceID, TargetID, 1, 1)--所属者ID
	local growtime = cre.GetCreatureScriptData(MapID, InstanceID, TargetID, 1, 2)--已浇水次数
	local HaveDelete_growthitem = 0

--1.5新增内容////////////////////////////////////////////////up,所有材料
	local Role = {}
	local seedownerRole = {}
	local TeamID = role.IsRoleHaveTeam(MapID, InstanceID, RoleID)
	local seedownerTeamID = role.IsRoleHaveTeam(MapID, InstanceID, seedowner)
	local IsInOwnerTeam = 0
	if TeamID ~= 4294967295 then
		Role[1], Role[2], Role[3], Role[4], Role[5], Role[6] = role.GetRoleTeamMemID(TeamID)
		for k = 1,6 do
			if seedowner == Role[k] then
				IsInOwnerTeam = 1
			end
		end
	end
	if seedownerTeamID ~= 4294967295 then
		seedownerRole[1], seedownerRole[2], seedownerRole[3], seedownerRole[4], seedownerRole[5], seedownerRole[6] = role.GetRoleTeamMemID(seedownerTeamID)
	end
--1.5新增内容/////////////////////////////////////////////////down,所有材料▲▲▲▲▲▲▲▲
    local farmer_level = role.GetRoleLevel(MapID, InstanceID, RoleID)
	if farmer_level > 120 then
	    local MsgID = msg.BeginMsgEvent()
		msg.AddMsgEvent(MsgID, 20, 1344)	-- "超过120级的玩家将无法参与种植！"
		msg.AddMsgEvent(MsgID, 24, TargetID)
		msg.DispatchRoleMsgEvent(RoleID, MsgID)
	else
		if TalkIndex == -1 then
			if seedowner ~= 0 then
				local MsgID = msg.BeginMsgEvent()
				msg.AddMsgEvent(MsgID, 20, 1301)	-- "###(玩家名)所种的###(植物名),灵种刚刚开始发芽，多多浇水可促进其生长！"
				msg.AddMsgEvent(MsgID, 2, seedowner)	--传入玩家名
				msg.AddMsgEvent(MsgID, 21, 4)	-- 选项一
				msg.AddMsgEvent(MsgID, 1, 1302)	-- "★浇水"
				msg.AddMsgEvent(MsgID, 21, 5)	-- 选项二
				msg.AddMsgEvent(MsgID, 1, 1303)	-- "离开"
				msg.AddMsgEvent(MsgID, 24, TargetID)
				msg.DispatchRoleMsgEvent(RoleID, MsgID)
				TalkIndex = -1
			else
				local MsgID = msg.BeginMsgEvent()
				msg.AddMsgEvent(MsgID, 20, 1323)	-- "百味灵壤刚刚开始发芽，多多浇水可促进其生长！\n它还没有主人，只要您浇过一次水即为它的新主人！"
				msg.AddMsgEvent(MsgID, 21, 4)	-- 选项一
				msg.AddMsgEvent(MsgID, 1, 1302)	-- "★浇水"
				msg.AddMsgEvent(MsgID, 21, 5)	-- 选项二
				msg.AddMsgEvent(MsgID, 1, 1303)	-- "离开"
				msg.AddMsgEvent(MsgID, 24, TargetID)
				msg.DispatchRoleMsgEvent(RoleID, MsgID)
				TalkIndex = -1
			end

		elseif TalkIndex == 4 then
			local MsgID = msg.BeginMsgEvent()
			msg.AddMsgEvent(MsgID, 20, 1304)	-- "浇水需要消耗1份【生命之水】或1份【生命灵水】，两次浇水之间需间隔1分钟；\n【生命灵水】为仙家圣水，其功效是普通【生命之水】的5倍！"
			msg.AddMsgEvent(MsgID, 21, 6)	-- 选项一
			msg.AddMsgEvent(MsgID, 1, 1305)	-- "★浇【生命之水】"
			msg.AddMsgEvent(MsgID, 21, 7)	-- 选项二
			msg.AddMsgEvent(MsgID, 1, 1306)	-- "★浇【生命灵水】"
			msg.AddMsgEvent(MsgID, 24, TargetID)
			msg.DispatchRoleMsgEvent(RoleID, MsgID)
			TalkIndex = -1

				--1.5新增内容//////////////////////////////////////////////////////////////////////////////up，所有材料
				local x, y, z = unit.GetPosition(MapID, InstanceID, TargetID)
				if seedowner ~= 0 and seedowner ~= RoleID and IsInOwnerTeam == 0 then
					local MsgID = msg.BeginMsgEvent()
					msg.AddMsgEvent(MsgID, 101, 1342) --"位于XX（地图名）[X,Z]的植物正被[RoleID]觊觎，请前往应对。"
					msg.AddMsgEvent(MsgID, 6, MapID)
					msg.AddMsgEvent(MsgID, 9, x)
					msg.AddMsgEvent(MsgID, 9, z)
					msg.AddMsgEvent(MsgID, 2, RoleID)
					msg.DispatchRoleMsgEvent(seedowner, MsgID)
					if seedownerTeamID ~= 4294967295 then
						for k in pairs(seedownerRole) do
							if seedownerRole[k] ~= 4294967295 then
								local MsgID = msg.BeginMsgEvent()
								msg.AddMsgEvent(MsgID, 101, 1342) --"位于XX（地图名）[X,Z]的植物正被[RoleID]觊觎，请前往应对。"
								msg.AddMsgEvent(MsgID, 6, MapID)
								msg.AddMsgEvent(MsgID, 9, x)
								msg.AddMsgEvent(MsgID, 9, z)
								msg.AddMsgEvent(MsgID, 2, RoleID)
								msg.DispatchRoleMsgEvent(seedownerRole[k], MsgID)
							end
						end
					end
				end
				--1.5新增内容///////////////////////////////////////////////////////////////////////////////down，所有材料▲▲▲▲▲▲▲

		elseif TalkIndex == 6 then
				local WaterNum = role.GetRoleItemNum(RoleID, 3303009)--生命之水数量

				if WaterNum > 0 then
					local cTime = os.time() --当前时间
					local lTime = cre.GetCreatureScriptData(MapID, InstanceID, TargetID, 1, 3)
					local s = os.difftime(cTime,lTime) --上次浇水距现在时间
					if 	s > 60 then --间隔大于1分钟

	--1.5新增内容////////////////////////////////////////////////////////////////////////////uuuuuuuupppppppppppppp，低级材料

						if seedowner == 0 or seedowner == RoleID or IsInOwnerTeam == 1 then --种子无所属者或者为所属或者所属在队伍中
							role.RemoveFromRole(MapID, InstanceID, RoleID, 3303009, 1, 101)---------删除生命之水
							growtime = growtime + 1	-------------------------记录操作次数
							cre.SetCreatureScriptData(MapID, InstanceID, TargetID, 1, 3, cTime)-----------高级材料不记录
							HaveDelete_growthitem = 1
							if TeamID == 4294967295 then
								local rolelevel = role.GetRoleLevel(MapID, InstanceID, RoleID)
								local roleexp = 100*growth_exp[rolelevel].pt-------------根据植物获得经验
								role.AddRoleExp(MapID, InstanceID, RoleID, roleexp)
								unit.AddBuff(MapID, InstanceID, TargetID, 5003801, TargetID)
							else
								local aroundmember = 0
								for k = 1,6 do
									if 4294967295 ~= Role[k] then
										local Role_MapID, Role_InstanceID = role.GetRoleMapID(Role[k])
										if Role_MapID == MapID or Role_InstanceID == InstanceID then
											local x1, y1, z1 = unit.GetPosition(MapID, InstanceID, TargetID)
											local x2, y2, z2 = unit.GetPosition(Role_MapID, Role_InstanceID, Role[k])
											if math.abs(x1-x2)<200 and math.abs(z1-z2)<200 then
												aroundmember = aroundmember + 1
											end
										end
									end
								end
								for k = 1,6 do
									if 4294967295 ~= Role[k] then
										local Role_MapID, Role_InstanceID = role.GetRoleMapID(Role[k])
										if Role_MapID == MapID or Role_InstanceID == InstanceID then
											local x1, y1, z1 = unit.GetPosition(MapID, InstanceID, TargetID)
											local x2, y2, z2 = unit.GetPosition(Role_MapID, Role_InstanceID, Role[k])
											if math.abs(x1-x2)<200 and math.abs(z1-z2)<200 then
												local rolelevel = role.GetRoleLevel(Role_MapID, Role_InstanceID, Role[k])
												local roleexp = 100*growth_exp[rolelevel].pt-------------根据植物获得经验
												if aroundmember == 1 then
													roleexp = roleexp
												else
													roleexp = roleexp/aroundmember *1.2
												end
												role.AddRoleExp(MapID, InstanceID, Role[k], roleexp)
												unit.AddBuff(MapID, InstanceID, TargetID, 5003801, TargetID)
											end
										end
									end
								end
							end
						else --抢树，不在所属者队中
							local MsgID = msg.BeginMsgEvent()
							msg.AddMsgEvent(MsgID, 20, 1341) --"此植物不属于你或你的小队，你必须开启自由模式才可以浇种，并准备接受各种虚弱惩罚。"
							msg.AddMsgEvent(MsgID, 21, 8)	-- 选项一
							msg.AddMsgEvent(MsgID, 1, 21)	-- "确定"
							msg.AddMsgEvent(MsgID, 21, 5)	-- 选项一
							msg.AddMsgEvent(MsgID, 1, 1303)	-- "离开"
							msg.AddMsgEvent(MsgID, 24, TargetID)
							msg.DispatchRoleMsgEvent(RoleID, MsgID)
						end
	--1.5新增内容////////////////////////////////////////////////////////////////////dddddooooooowwwwwwnnnnnn，低级材料▲▲▲▲▲


					else
						local MsgID = msg.BeginMsgEvent()
						msg.AddMsgEvent(MsgID, 20, 1307)-- "对该植物的两次浇水间隔不足1分钟，为防止频繁浇水对植物造成的伤害，请您稍等片刻再来浇水。"
						msg.AddMsgEvent(MsgID, 21, 5)	-- 选项一
						msg.AddMsgEvent(MsgID, 1, 1303)	-- "离开"
						msg.AddMsgEvent(MsgID, 24, TargetID)
						msg.DispatchRoleMsgEvent(RoleID, MsgID)
					end
				else
					local MsgID = msg.BeginMsgEvent()
					msg.AddMsgEvent(MsgID, 20, 1308) --"您没有生命之水。\n生命之水可在种植商人处进行购买，或通过完成大农丞处的“年货大采购”任务获得。"
					msg.AddMsgEvent(MsgID, 21, 5)	-- 选项一
					msg.AddMsgEvent(MsgID, 1, 1303)	-- "离开"
					msg.DispatchRoleMsgEvent(RoleID, MsgID)
				end
				TalkIndex = -1
		elseif TalkIndex == 7 then
				local WaterNum = role.GetRoleItemNum(RoleID, 3303010)--生命灵水数量
				if WaterNum > 0 then
					local cTime = os.time() --当前时间
					local lTime = cre.GetCreatureScriptData(MapID, InstanceID, TargetID, 1, 3)
					local s = os.difftime(cTime,lTime) --上次浇水距现在时间

					if 	s > 60 then --间隔大于1分钟
	--1.5新增内容////////////////////////////////////////////////////////////////////////////uuuuuuuupppppppppppppp，高级材料
						if seedowner == 0 or seedowner == RoleID or IsInOwnerTeam == 1 then --种子无所属者或者为所属或者所属在队伍中
							role.RemoveFromRole(MapID, InstanceID, RoleID, 3303010, 1, 101)---------删除生命灵水
							growtime = 5	-------------------------记录操作次数
							HaveDelete_growthitem = 1
							if TeamID == 4294967295 then
								local rolelevel = role.GetRoleLevel(MapID, InstanceID, RoleID)
								local roleexp = 100*growth_exp[rolelevel].im-------------根据植物获得经验
								role.AddRoleExp(MapID, InstanceID, RoleID, roleexp)
								unit.AddBuff(MapID, InstanceID, TargetID, 5003801, TargetID)
							else
								local aroundmember = 0
								for k = 1,6 do
									if 4294967295 ~= Role[k] then
										local Role_MapID, Role_InstanceID = role.GetRoleMapID(Role[k])
										if Role_MapID == MapID or Role_InstanceID == InstanceID then
											local x1, y1, z1 = unit.GetPosition(MapID, InstanceID, TargetID)
											local x2, y2, z2 = unit.GetPosition(Role_MapID, Role_InstanceID, Role[k])
											if math.abs(x1-x2)<200 and math.abs(z1-z2)<200 then
												aroundmember = aroundmember + 1
											end
										end
									end
								end
								for k = 1,6 do
									if 4294967295 ~= Role[k] then
										local Role_MapID, Role_InstanceID = role.GetRoleMapID(Role[k])
										if Role_MapID == MapID or Role_InstanceID == InstanceID then
											local x1, y1, z1 = unit.GetPosition(MapID, InstanceID, TargetID)
											local x2, y2, z2 = unit.GetPosition(Role_MapID, Role_InstanceID, Role[k])
											if math.abs(x1-x2)<200 and math.abs(z1-z2)<200 then
												local rolelevel = role.GetRoleLevel(Role_MapID, Role_InstanceID, Role[k])
												local roleexp = 100*growth_exp[rolelevel].im-------------根据植物获得经验
												if aroundmember == 1 then
													roleexp = roleexp
												else
													roleexp = roleexp/aroundmember *1.2
												end
												role.AddRoleExp(MapID, InstanceID, Role[k], roleexp)
												unit.AddBuff(MapID, InstanceID, TargetID, 5003801, TargetID)
											end
										end
									end
								end
							end
						else --抢树，不在所属者队中
							local MsgID = msg.BeginMsgEvent()
							msg.AddMsgEvent(MsgID, 20, 1341) --"此植物不属于你或你的小队，你必须开启自由模式才可以浇种，并准备接受各种虚弱惩罚。"
							msg.AddMsgEvent(MsgID, 21, 9)	-- 选项一-------------------------------根据材料填，此处高级9
							msg.AddMsgEvent(MsgID, 1, 21)	-- "确定"
							msg.AddMsgEvent(MsgID, 21, 5)	-- 选项一
							msg.AddMsgEvent(MsgID, 1, 1303)	-- "离开"
							msg.AddMsgEvent(MsgID, 24, TargetID)
							msg.DispatchRoleMsgEvent(RoleID, MsgID)
						end
	--1.5新增内容////////////////////////////////////////////////////////////////////dddddooooooowwwwwwnnnnnn，高级材料▲▲▲▲▲
					else
						local MsgID = msg.BeginMsgEvent()
						msg.AddMsgEvent(MsgID, 20, 1307)	-- "对该植物的两次浇水间隔不足1分钟，为防止频繁浇水对植物造成的伤害，请您稍等片刻再来浇水。"
						msg.AddMsgEvent(MsgID, 21, 5)	-- 选项一
						msg.AddMsgEvent(MsgID, 1, 1303)	-- "离开"
						msg.AddMsgEvent(MsgID, 24, TargetID)
						msg.DispatchRoleMsgEvent(RoleID, MsgID)
					end
				else
					local MsgID = msg.BeginMsgEvent()
					msg.AddMsgEvent(MsgID, 20, 1309) --"您没有生命灵水。\n生命灵水乃是仙家圣水，可遇而不可求，听说在大农丞处完成“年货大采购”任务将有较小几率获得生命灵水，另外开启“金虎如意匣”或“新春红包”等均有一定几率获得生命灵水。\n或者您可以尝试使用普通生命之水对该植物进行浇水"
					msg.AddMsgEvent(MsgID, 21, 5)	-- 选项一
					msg.AddMsgEvent(MsgID, 1, 1303)	-- "离开"
					msg.DispatchRoleMsgEvent(RoleID, MsgID)
				end
				TalkIndex = -1
	--///////.///////////////////////////////////////////////////////////////////////////////////////1.5up,低级材料
		elseif TalkIndex == 8 then
			local Temp = 1
			if role.IsRoleInStatus(RoleID, 1048576) == false then --必须开启自由才可以抢树。
				local MsgID = msg.BeginMsgEvent()
				msg.AddMsgEvent(MsgID, 20, 1341) --"此植物不属于你或你的小队，你必须开启自由模式才可以浇种，并准备接受各种虚弱惩罚。"
				msg.AddMsgEvent(MsgID, 21, 5)	-- 选项一
				msg.AddMsgEvent(MsgID, 1, 1303)	-- "离开"
				msg.AddMsgEvent(MsgID, 24, TargetID)
				msg.DispatchRoleMsgEvent(RoleID, MsgID)
				Temp = 0
			end
			if Temp == 1 then
				role.RemoveFromRole(MapID, InstanceID, RoleID, 3303009, 1, 101)--------------删除生命之水
				growtime = growtime + 1-------------------------记录操作次数
				local cTime = os.time() --当前时间
				local rolelevel = role.GetRoleLevel(MapID, InstanceID, RoleID)
				cre.SetCreatureScriptData(MapID, InstanceID, TargetID, 1, 3, cTime)------------高级材料不记录
				HaveDelete_growthitem = 1
				local roleexp = 100*growth_exp[rolelevel].pt-----------------根据植物给经验
				role.AddRoleExp(MapID, InstanceID, RoleID, roleexp)
				unit.AddBuff(MapID, InstanceID, TargetID, 5003801, TargetID)
				unit.AddBuff(MapID, InstanceID, RoleID, 2025601, RoleID)
				local MsgID = msg.BeginMsgEvent()
				msg.AddMsgEvent(MsgID, 26, 1343) --"此植物不属于你或你的队友，因此你受到了虚弱效果的影响。"
				msg.DispatchRoleMsgEvent(RoleID, MsgID)
			end
	--/////////////////////////////////////////////////////////////////////////////////////////////////1.5down，低级材料▲▲▲▲▲
	--///////.///////////////////////////////////////////////////////////////////////////////////////1.5up,高级材料
		elseif TalkIndex == 9 then
			local Temp = 1
			if role.IsRoleInStatus(RoleID, 1048576) == false then --必须开启自由才可以抢树。
				local MsgID = msg.BeginMsgEvent()
				msg.AddMsgEvent(MsgID, 20, 1341) --"此植物不属于你或你的小队，你必须开启自由模式才可以浇种，并准备接受各种虚弱惩罚。"
				msg.AddMsgEvent(MsgID, 21, 5)	-- 选项一
				msg.AddMsgEvent(MsgID, 1, 1303)	-- "离开"
				msg.AddMsgEvent(MsgID, 24, TargetID)
				msg.DispatchRoleMsgEvent(RoleID, MsgID)
				Temp = 0
			end
			if Temp == 1 then
				role.RemoveFromRole(MapID, InstanceID, RoleID, 3303010, 1, 101)--------------删除生命灵水
				growtime = 5-------------------------记录操作次数
				HaveDelete_growthitem = 1
				local rolelevel = role.GetRoleLevel(MapID, InstanceID, RoleID)
				local roleexp = 100*growth_exp[rolelevel].im-----------------根据植物给经验
				role.AddRoleExp(MapID, InstanceID, RoleID, roleexp)
				unit.AddBuff(MapID, InstanceID, TargetID, 5003801, TargetID)
				unit.AddBuff(MapID, InstanceID, RoleID, 2025601, RoleID)
				local MsgID = msg.BeginMsgEvent()
				msg.AddMsgEvent(MsgID, 26, 1343) --"此植物不属于你或你的队友，因此你受到了虚弱效果的影响。"
				msg.DispatchRoleMsgEvent(RoleID, MsgID)
			end
	--/////////////////////////////////////////////////////////////////////////////////////////////////1.5down，高级材料▲▲▲▲▲
		end
	end

	if 	HaveDelete_growthitem == 1 then
			--增加进阶实力值
		Increase_shili(MapID, InstanceID, RoleID, 0, 1,"jinjieshili_A")

		if growtime == 5 then
			local x, y, z = unit.GetPosition(MapID, InstanceID, TargetID)
			local creatureID = map.MapCreateCreature(MapID, InstanceID, 4900409, x, y, z)
			if seedowner == 0 then
			seedowner = RoleID
			end
			cre.SetCreatureScriptData(MapID, InstanceID, creatureID, 1, 1, seedowner)
			local MsgID = msg.BeginMsgEvent()
			msg.AddMsgEvent(MsgID, 13, 0)
			msg.AddMsgEvent(MsgID, 1, 1321)--您所种植物经过几番浇水开始茁壮成长，距离最终收获已经不远，恭喜恭喜！
			msg.DispatchRoleMsgEvent(seedowner, MsgID)

			map.MapDeleteCreature(MapID, InstanceID, TargetID)
		else
			cre.SetCreatureScriptData(MapID, InstanceID, TargetID, 1, 2, growtime)--记录此土堆的浇水次数
			if seedowner == 0 then
			cre.SetCreatureScriptData(MapID, InstanceID, TargetID, 1, 1, RoleID)
			end
			local MsgID = msg.BeginMsgEvent()
			msg.AddMsgEvent(MsgID, 26, 1310)	-- "使当前植物生长还需用【生命之水】浇灌XXX次，或者直接使用【生命灵水】浇灌一次。"
			msg.AddMsgEvent(MsgID, 9, 5-growtime)	--传入还可浇灌的次数
			msg.AddMsgEvent(MsgID, 24, TargetID)
			msg.DispatchRoleMsgEvent(RoleID, MsgID)
		end
	end
end

aux.RegisterCreatureEvent(4900408, 7, "BaiWeiTu_OnTalk")








--与百味灵树对话，百味树
function BaiWeiShu_OnTalk(MapID, InstanceID, TargetID, TargetTypeID, RoleID, TalkIndex)
	local seedowner = cre.GetCreatureScriptData(MapID, InstanceID, TargetID, 1, 1)--所属者ID
	local growtime = cre.GetCreatureScriptData(MapID, InstanceID, TargetID, 1, 2)--已浇水次数
	local HaveDelete_growthitem = 0
--1.5新增内容////////////////////////////////////////////////up,所有材料
	local Role = {}
	local seedownerRole = {}
	local TeamID = role.IsRoleHaveTeam(MapID, InstanceID, RoleID)
	local seedownerTeamID = role.IsRoleHaveTeam(MapID, InstanceID, seedowner)
	local IsInOwnerTeam = 0
	if TeamID ~= 4294967295 then
		Role[1], Role[2], Role[3], Role[4], Role[5], Role[6] = role.GetRoleTeamMemID(TeamID)
		for k = 1,6 do
			if seedowner == Role[k] then
				IsInOwnerTeam = 1
			end
		end
	end
	if seedownerTeamID ~= 4294967295 then
		seedownerRole[1], seedownerRole[2], seedownerRole[3], seedownerRole[4], seedownerRole[5], seedownerRole[6] = role.GetRoleTeamMemID(seedownerTeamID)
	end
--1.5新增内容/////////////////////////////////////////////////down,所有材料▲▲▲▲▲▲▲▲
	local farmer_level = role.GetRoleLevel(MapID, InstanceID, RoleID)
	if farmer_level > 120 then
	    local MsgID = msg.BeginMsgEvent()
		msg.AddMsgEvent(MsgID, 20, 1344)	-- "超过120级的玩家将无法参与种植！"
		msg.AddMsgEvent(MsgID, 24, TargetID)
		msg.DispatchRoleMsgEvent(RoleID, MsgID)
	else
		if TalkIndex == -1 then
			if seedowner ~= 0 then
				local MsgID = msg.BeginMsgEvent()
				msg.AddMsgEvent(MsgID, 20, 1311)	-- "###(玩家名)所种的###(植物名),幼苗开始茁壮成长，请多多施肥保证养分！"
				msg.AddMsgEvent(MsgID, 2, seedowner)	--传入玩家名
				msg.AddMsgEvent(MsgID, 21, 4)	-- 选项一
				msg.AddMsgEvent(MsgID, 1, 1312)	-- "★施肥"
				msg.AddMsgEvent(MsgID, 21, 5)	-- 选项二
				msg.AddMsgEvent(MsgID, 1, 1303)	-- "离开"
				msg.AddMsgEvent(MsgID, 24, TargetID)
				msg.DispatchRoleMsgEvent(RoleID, MsgID)
				TalkIndex = -1
			else
				local MsgID = msg.BeginMsgEvent()
				msg.AddMsgEvent(MsgID, 20, 1330)	-- "百味灵壤刚刚开始发芽，多多浇水可促进其生长！\n它还没有主人，只要您浇过一次水即为它的新主人！"
				msg.AddMsgEvent(MsgID, 21, 4)	-- 选项一
				msg.AddMsgEvent(MsgID, 1, 1302)	-- "★施肥"
				msg.AddMsgEvent(MsgID, 21, 5)	-- 选项二
				msg.AddMsgEvent(MsgID, 1, 1303)	-- "离开"
				msg.AddMsgEvent(MsgID, 24, TargetID)
				msg.DispatchRoleMsgEvent(RoleID, MsgID)
				TalkIndex = -1
			end
		elseif TalkIndex == 4 then
				local MsgID = msg.BeginMsgEvent()
				msg.AddMsgEvent(MsgID, 20, 1313)-- "施肥需要消耗1份【培土农肥】或1份【培土灵肥】，两次施肥之间需间隔1分钟；\n【培土灵肥】功效是普通【培土农肥】的5倍！"
				msg.AddMsgEvent(MsgID, 21, 6)	-- 选项一
				msg.AddMsgEvent(MsgID, 1, 1314)	-- "★施【培土农肥】"
				msg.AddMsgEvent(MsgID, 21, 7)	-- 选项二
				msg.AddMsgEvent(MsgID, 1, 1315)	-- "★施【培土灵肥】"
				msg.AddMsgEvent(MsgID, 24, TargetID)
				msg.DispatchRoleMsgEvent(RoleID, MsgID)
				TalkIndex = -1
				--1.5新增内容//////////////////////////////////////////////////////////////////////////////up，所有材料
				local x, y, z = unit.GetPosition(MapID, InstanceID, TargetID)
				if seedowner ~= 0 and seedowner ~= RoleID and IsInOwnerTeam == 0 then
					local MsgID = msg.BeginMsgEvent()
					msg.AddMsgEvent(MsgID, 101, 1342) --"位于XX（地图名）[X,Z]的植物正被[RoleID]觊觎，请前往应对。"
					msg.AddMsgEvent(MsgID, 6, MapID)
					msg.AddMsgEvent(MsgID, 9, x)
					msg.AddMsgEvent(MsgID, 9, z)
					msg.AddMsgEvent(MsgID, 2, RoleID)
					msg.DispatchRoleMsgEvent(seedowner, MsgID)
					if seedownerTeamID ~= 4294967295 then
						for k in pairs(seedownerRole) do
							if seedownerRole[k] ~= 4294967295 then
								local MsgID = msg.BeginMsgEvent()
								msg.AddMsgEvent(MsgID, 101, 1342) --"位于XX（地图名）[X,Z]的植物正被[RoleID]觊觎，请前往应对。"
								msg.AddMsgEvent(MsgID, 6, MapID)
								msg.AddMsgEvent(MsgID, 9, x)
								msg.AddMsgEvent(MsgID, 9, z)
								msg.AddMsgEvent(MsgID, 2, RoleID)
								msg.DispatchRoleMsgEvent(seedownerRole[k], MsgID)
							end
						end
					end
				end
				--1.5新增内容///////////////////////////////////////////////////////////////////////////////down，所有材料▲▲▲▲▲▲▲
		elseif TalkIndex == 6 then
				local ManureNum = role.GetRoleItemNum(RoleID, 3303011)--培土农肥数量
				if ManureNum > 0 then
					local cTime = os.time() --当前时间
					local lTime = cre.GetCreatureScriptData(MapID, InstanceID, TargetID, 1, 3)
					local s = os.difftime(cTime,lTime) --上次施肥距现在时间
					if 	s > 60 then --间隔大于1分
	--1.5新增内容////////////////////////////////////////////////////////////////////////////uuuuuuuupppppppppppppp，低级材料
						if seedowner == 0 or seedowner == RoleID or IsInOwnerTeam == 1 then --种子无所属者或者为所属或者所属在队伍中
							role.RemoveFromRole(MapID, InstanceID, RoleID, 3303011, 1, 101)---------删除普通肥
							growtime = growtime + 1	-------------------------记录操作次数
							cre.SetCreatureScriptData(MapID, InstanceID, TargetID, 1, 3, cTime)-----------高级材料不记录时间
							HaveDelete_growthitem = 1
							if TeamID == 4294967295 then
								local rolelevel = role.GetRoleLevel(MapID, InstanceID, RoleID)
								local roleexp = 100*growth_exp[rolelevel].pt-------------根据植物获得经验
								role.AddRoleExp(MapID, InstanceID, RoleID, roleexp)
								unit.AddBuff(MapID, InstanceID, TargetID, 5003901, TargetID)-----浇水或是施肥
							else
								local aroundmember = 0
								for k = 1,6 do
									if 4294967295 ~= Role[k] then
										local Role_MapID, Role_InstanceID = role.GetRoleMapID(Role[k])
										if Role_MapID == MapID or Role_InstanceID == InstanceID then
											local x1, y1, z1 = unit.GetPosition(MapID, InstanceID, TargetID)
											local x2, y2, z2 = unit.GetPosition(Role_MapID, Role_InstanceID, Role[k])
											if math.abs(x1-x2)<200 and math.abs(z1-z2)<200 then
												aroundmember = aroundmember + 1
											end
										end
									end
								end
								for k = 1,6 do
									if 4294967295 ~= Role[k] then
										local Role_MapID, Role_InstanceID = role.GetRoleMapID(Role[k])
										if Role_MapID == MapID or Role_InstanceID == InstanceID then
											local x1, y1, z1 = unit.GetPosition(MapID, InstanceID, TargetID)
											local x2, y2, z2 = unit.GetPosition(Role_MapID, Role_InstanceID, Role[k])
											if math.abs(x1-x2)<200 and math.abs(z1-z2)<200 then
												local rolelevel = role.GetRoleLevel(Role_MapID, Role_InstanceID, Role[k])
												local roleexp = 100*growth_exp[rolelevel].pt-------------根据植物获得经验
												if aroundmember == 1 then
													roleexp = roleexp
												else
													roleexp = roleexp/aroundmember *1.2
												end
												role.AddRoleExp(MapID, InstanceID, Role[k], roleexp)
												unit.AddBuff(MapID, InstanceID, TargetID, 5003901, TargetID)-----浇水或是施肥
											end
										end
									end
								end
							end
						else --抢树，不在所属者队中
							local MsgID = msg.BeginMsgEvent()
							msg.AddMsgEvent(MsgID, 20, 1341) --"此植物不属于你或你的小队，你必须开启自由模式才可以浇种，并准备接受各种虚弱惩罚。"
							msg.AddMsgEvent(MsgID, 21, 8)	-- 选项一
							msg.AddMsgEvent(MsgID, 1, 21)	-- "确定"
							msg.AddMsgEvent(MsgID, 21, 5)	-- 选项一
							msg.AddMsgEvent(MsgID, 1, 1303)	-- "离开"
							msg.AddMsgEvent(MsgID, 24, TargetID)
							msg.DispatchRoleMsgEvent(RoleID, MsgID)
						end
	--1.5新增内容////////////////////////////////////////////////////////////////////dddddooooooowwwwwwnnnnnn，低级材料▲▲▲▲▲
					else
						local MsgID = msg.BeginMsgEvent()
						msg.AddMsgEvent(MsgID, 20, 1316)-- "对该植物的两次施肥间隔不足1分钟，为防止频繁施肥对植物造成的伤害，请您稍等片刻再来施肥。"
						msg.AddMsgEvent(MsgID, 21, 5)	-- 选项一
						msg.AddMsgEvent(MsgID, 1, 1303)	-- "离开"
						msg.AddMsgEvent(MsgID, 24, TargetID)
						msg.DispatchRoleMsgEvent(RoleID, MsgID)
					end
				else

					local MsgID = msg.BeginMsgEvent()
					msg.AddMsgEvent(MsgID, 20, 1317) --"您没有培土农肥。\n培土农肥可在种植商人处进行购买，或通过完成大农丞处的“年货大采购”任务获得。"
					msg.AddMsgEvent(MsgID, 21, 5)	-- 选项一
					msg.AddMsgEvent(MsgID, 1, 1303)	-- "离开"
					msg.DispatchRoleMsgEvent(RoleID, MsgID)
				end
				TalkIndex = -1
		elseif TalkIndex == 7 then
				local ManureNum = role.GetRoleItemNum(RoleID, 3303012)--培土灵肥数量
				if ManureNum > 0 then
					local cTime = os.time() --当前时间
					local lTime = cre.GetCreatureScriptData(MapID, InstanceID, TargetID, 1, 3)
					local s = os.difftime(cTime,lTime) --上次施肥距现在时间
					if 	s > 60 then --间隔大于1分钟--
	--1.5新增内容////////////////////////////////////////////////////////////////////////////uuuuuuuupppppppppppppp，高级材料
						if seedowner == 0 or seedowner == RoleID or IsInOwnerTeam == 1 then --种子无所属者或者为所属或者所属在队伍中
							role.RemoveFromRole(MapID, InstanceID, RoleID, 3303012, 1, 101)---------删除高级肥
							growtime = 5	-------------------------记录操作次数
							HaveDelete_growthitem = 1
							if TeamID == 4294967295 then
								local rolelevel = role.GetRoleLevel(MapID, InstanceID, RoleID)
								local roleexp = 100*growth_exp[rolelevel].im-------------根据植物获得经验
								role.AddRoleExp(MapID, InstanceID, RoleID, roleexp)
								unit.AddBuff(MapID, InstanceID, TargetID, 5003901, TargetID)-----浇水或是施肥
							else
								local aroundmember = 0
								for k = 1,6 do
									if 4294967295 ~= Role[k] then
										local Role_MapID, Role_InstanceID = role.GetRoleMapID(Role[k])
										if Role_MapID == MapID or Role_InstanceID == InstanceID then
											local x1, y1, z1 = unit.GetPosition(MapID, InstanceID, TargetID)
											local x2, y2, z2 = unit.GetPosition(Role_MapID, Role_InstanceID, Role[k])
											if math.abs(x1-x2)<200 and math.abs(z1-z2)<200 then
												aroundmember = aroundmember + 1
											end
										end
									end
								end
								for k = 1,6 do
									if 4294967295 ~= Role[k] then
										local Role_MapID, Role_InstanceID = role.GetRoleMapID(Role[k])
										if Role_MapID == MapID or Role_InstanceID == InstanceID then
											local x1, y1, z1 = unit.GetPosition(MapID, InstanceID, TargetID)
											local x2, y2, z2 = unit.GetPosition(Role_MapID, Role_InstanceID, Role[k])
											if math.abs(x1-x2)<200 and math.abs(z1-z2)<200 then
												local rolelevel = role.GetRoleLevel(Role_MapID, Role_InstanceID, Role[k])
												local roleexp = 100*growth_exp[rolelevel].im-------------根据植物获得经验
												if aroundmember == 1 then
													roleexp = roleexp
												else
													roleexp = roleexp/aroundmember *1.2
												end
												role.AddRoleExp(MapID, InstanceID, Role[k], roleexp)
												unit.AddBuff(MapID, InstanceID, TargetID, 5003901, TargetID)-----浇水或是施肥
											end
										end
									end
								end
							end
						else --抢树，不在所属者队中
							local MsgID = msg.BeginMsgEvent()
							msg.AddMsgEvent(MsgID, 20, 1341) --"此植物不属于你或你的小队，你必须开启自由模式才可以浇种，并准备接受各种虚弱惩罚。"
							msg.AddMsgEvent(MsgID, 21, 9)	-- 选项一-------------------------------根据材料填，此处高级9
							msg.AddMsgEvent(MsgID, 1, 21)	-- "确定"
							msg.AddMsgEvent(MsgID, 21, 5)	-- 选项一
							msg.AddMsgEvent(MsgID, 1, 1303)	-- "离开"
							msg.AddMsgEvent(MsgID, 24, TargetID)
							msg.DispatchRoleMsgEvent(RoleID, MsgID)
						end
	--1.5新增内容////////////////////////////////////////////////////////////////////dddddooooooowwwwwwnnnnnn，高级材料▲▲▲▲▲
					else
						local MsgID = msg.BeginMsgEvent()
						msg.AddMsgEvent(MsgID, 20, 1316)-- "对该植物的两次施肥间隔不足1分钟，为防止频繁施肥对植物造成的伤害，请您稍等片刻再来施肥。"
						msg.AddMsgEvent(MsgID, 21, 5)	-- 选项一
						msg.AddMsgEvent(MsgID, 1, 1303)	-- "离开"
						msg.AddMsgEvent(MsgID, 24, TargetID)
						msg.DispatchRoleMsgEvent(RoleID, MsgID)
					end
				else
					local MsgID = msg.BeginMsgEvent()
					msg.AddMsgEvent(MsgID, 20, 1318) --"您没有培土灵肥。\n培土灵肥乃是仙家圣物，可遇而不可求，听说在大农丞处完成“年货大采购”任务将有较小几率获得培土灵肥，另外开启“金虎如意匣”或“新春红包”等均有一定几率获得。\n或者您可以尝试使用普通培土农肥对该植物进行施肥。"
					msg.AddMsgEvent(MsgID, 21, 5)	-- 选项一
					msg.AddMsgEvent(MsgID, 1, 1303)	-- "离开"
					msg.DispatchRoleMsgEvent(RoleID, MsgID)
				end
				TalkIndex = -1
	--///////.///////////////////////////////////////////////////////////////////////////////////////1.5up,低级材料
		elseif TalkIndex == 8 then
			local Temp = 1
			if role.IsRoleInStatus(RoleID, 1048576) == false then --必须开启自由才可以抢树。
				local MsgID = msg.BeginMsgEvent()
				msg.AddMsgEvent(MsgID, 20, 1341) --"此植物不属于你或你的小队，你必须开启自由模式才可以浇种，并准备接受各种虚弱惩罚。"
				msg.AddMsgEvent(MsgID, 21, 5)	-- 选项一
				msg.AddMsgEvent(MsgID, 1, 1303)	-- "离开"
				msg.AddMsgEvent(MsgID, 24, TargetID)
				msg.DispatchRoleMsgEvent(RoleID, MsgID)
				Temp = 0
			end
			if Temp == 1 then
				role.RemoveFromRole(MapID, InstanceID, RoleID, 3303011, 1, 101)--------------删除低级肥
				growtime = growtime + 1-------------------------记录操作次数
				local cTime = os.time() --当前时间
				local rolelevel = role.GetRoleLevel(MapID, InstanceID, RoleID)
				cre.SetCreatureScriptData(MapID, InstanceID, TargetID, 1, 3, cTime)------------高级材料不记录
				HaveDelete_growthitem = 1
				local roleexp = 100*growth_exp[rolelevel].pt-----------------根据植物给经验
				role.AddRoleExp(MapID, InstanceID, RoleID, roleexp)
				unit.AddBuff(MapID, InstanceID, TargetID, 5003901, TargetID)-----浇水或是施肥
				unit.AddBuff(MapID, InstanceID, RoleID, 2025601, RoleID)
				local MsgID = msg.BeginMsgEvent()
				msg.AddMsgEvent(MsgID, 26, 1343) --"此植物不属于你或你的队友，因此你受到了虚弱效果的影响。"
				msg.DispatchRoleMsgEvent(RoleID, MsgID)
			end
	--/////////////////////////////////////////////////////////////////////////////////////////////////1.5down，低级材料▲▲▲▲▲
	--///////.///////////////////////////////////////////////////////////////////////////////////////1.5up,高级材料
		elseif TalkIndex == 9 then
			local Temp = 1
			if role.IsRoleInStatus(RoleID, 1048576) == false then --必须开启自由才可以抢树。
				local MsgID = msg.BeginMsgEvent()
				msg.AddMsgEvent(MsgID, 20, 1341) --"此植物不属于你或你的小队，你必须开启自由模式才可以浇种，并准备接受各种虚弱惩罚。"
				msg.AddMsgEvent(MsgID, 21, 5)	-- 选项一
				msg.AddMsgEvent(MsgID, 1, 1303)	-- "离开"
				msg.DispatchRoleMsgEvent(RoleID, MsgID)
				Temp = 0
			end
			if Temp == 1 then
				role.RemoveFromRole(MapID, InstanceID, RoleID, 3303012, 1, 101)--------------删除高级肥
				growtime = 5-------------------------记录操作次数
				HaveDelete_growthitem = 1
				local rolelevel = role.GetRoleLevel(MapID, InstanceID, RoleID)
				local roleexp = 100*growth_exp[rolelevel].im-----------------根据植物给经验
				role.AddRoleExp(MapID, InstanceID, RoleID, roleexp)
				unit.AddBuff(MapID, InstanceID, TargetID, 5003901, TargetID)-----浇水或是施肥
				unit.AddBuff(MapID, InstanceID, RoleID, 2025601, RoleID)
				local MsgID = msg.BeginMsgEvent()
				msg.AddMsgEvent(MsgID, 26, 1343) --"此植物不属于你或你的队友，因此你受到了虚弱效果的影响。"
				msg.DispatchRoleMsgEvent(RoleID, MsgID)
			end
	--/////////////////////////////////////////////////////////////////////////////////////////////////1.5down，高级材料▲▲▲▲▲
		end
	end


	if 	HaveDelete_growthitem == 1 then
			--增加进阶实力值
			Increase_shili(MapID, InstanceID, RoleID, 0, 1,"jinjieshili_A")

		if growtime == 5 then
			local i = math.random(1,200)--0.5%几率
			if i ~= 99 then
				local x, y, z = unit.GetPosition(MapID, InstanceID, TargetID)
				local creatureID = map.MapCreateCreature(MapID, InstanceID, 4900410, x, y, z)
				if seedowner == 0 then
				seedowner = RoleID
				end
				cre.SetCreatureScriptData(MapID, InstanceID, creatureID, 1, 1, seedowner)--记录种植出【百味灵树】玩家的ID

				local MsgID = msg.BeginMsgEvent()
				msg.AddMsgEvent(MsgID, 13, 0)
				msg.AddMsgEvent(MsgID, 1, 1320)--您所种植的植物在几次施肥后终于开花结果，请您尽快前往收获，以防其枯萎！
				msg.DispatchRoleMsgEvent(seedowner, MsgID)
			else
				local MsgID = msg.BeginMsgEvent()
				msg.AddMsgEvent(MsgID, 13, 0)
				msg.AddMsgEvent(MsgID, 1, 1324)--"您在耕种过程中意外惊醒沉睡于万花之中的万花仙子，非但一无所获，还招致万花仙子大怒临凡！"
				msg.DispatchRoleMsgEvent(RoleID, MsgID)
				local MsgID1 = msg.BeginMsgEvent()
				msg.AddMsgEvent(MsgID1, 26, 1324)	-- "您在耕种过程中意外惊醒沉睡于万花之中的万花仙子，非但一无所获，还招致万花仙子大怒临凡！"
				msg.DispatchRoleMsgEvent(RoleID, MsgID1)

				map.MapCreateCreature(3017298383, InstanceID, 1534101,854,10000,1836)

				local MsgID = msg.BeginMsgEvent()
				msg.AddMsgEvent(MsgID, 100, 1325)--"&lt;p1&gt;在耕种过程中意外惊醒万花仙子，亲临凤翔府泄愤，5分钟后即将展开攻击，请各位英雄速速前往应对！"
				msg.AddMsgEvent(MsgID, 2, RoleID)	--传入玩家名
				msg.DispatchWorldMsgEvent(MsgID)
			end


			map.MapDeleteCreature(MapID, InstanceID, TargetID)

		else
			if seedowner == 0 then
			cre.SetCreatureScriptData(MapID, InstanceID, TargetID, 1, 1, RoleID)
			end
			cre.SetCreatureScriptData(MapID, InstanceID, TargetID, 1, 2, growtime)--记录此土堆的浇水次数
			local MsgID = msg.BeginMsgEvent()
			msg.AddMsgEvent(MsgID, 26, 1319)	-- "使当前植物结果还需用【培土农肥】施肥XXX次，或者直接使用【培土灵肥】施肥一次。"
			msg.AddMsgEvent(MsgID, 9, 5-growtime)	--传入还可浇灌的次数
			msg.AddMsgEvent(MsgID, 24, TargetID)
			msg.DispatchRoleMsgEvent(RoleID, MsgID)
		end

	end
end

aux.RegisterCreatureEvent(4900409, 7, "BaiWeiShu_OnTalk")

function C1534101_OnDie(MapID, InstanceID, CreatureID, CreatureTypeID, RoleID)
	local ID = 0
	local FreeSize = role.GetBagFreeSize(RoleID)
	if FreeSize >0 then
		local MsgID = msg.BeginMsgEvent()
		msg.AddMsgEvent(MsgID, 100, 1326)
		msg.AddMsgEvent(MsgID, 2, RoleID)	--传入玩家名
		msg.DispatchWorldMsgEvent(MsgID)
	end

end

aux.RegisterCreatureEvent(1534101, 4, "C1534101_OnDie")


--调查种出的各种箱子
function ZhongZhi_OnInVest(MapID, InstanceID, CreatureID, CreatureTypeID, RoleID)
	local r = math.random(1,100)
	local x, y, z = unit.GetPosition(MapID, InstanceID, RoleID)
	if r >= 95 then
		map.MapCreateColCreature(MapID, InstanceID, 1534105, x, y, z, 1)
	end
	local n = math.random(1,2000)
	if n == 1999 then
		role.AddRoleItem(MapID, InstanceID, RoleID, 3303007, 1, -1, 8, 102) --珍肴灵种
		local MsgID = msg.BeginMsgEvent()
		msg.AddMsgEvent(MsgID, 13, 1)
		msg.AddMsgEvent(MsgID, 1, 2129) --&lt;p1&gt;辛苦种植后，意外收获“&lt;p2&gt”一个
		msg.AddMsgEvent(MsgID, 2, RoleID)
		msg.AddMsgEvent(MsgID, 4, 3303007)
		msg.DispatchWorldMsgEvent(MsgID)
	end
end
aux.RegisterCreatureEvent(4900410, 6, "ZhongZhi_OnInVest")
aux.RegisterCreatureEvent(4900413, 6, "ZhongZhi_OnInVest")
aux.RegisterCreatureEvent(4900416, 6, "ZhongZhi_OnInVest")
